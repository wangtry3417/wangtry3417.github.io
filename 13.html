<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>尊爵會所 • 13張私人牌局 (VIP)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* --- 全局設置與背景 --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 100%);
            color: #e6d8b8;
            min-height: 100vh;
            font-family: 'Playfair Display', serif;
            overflow-x: hidden;
            position: relative;
        }

        .gold-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://www.transparenttextures.com/patterns/dark-wood.png');
            opacity: 0.2;
            z-index: -2;
        }

        .diamond-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 25% 25%, rgba(212, 175, 55, 0.03) 1px, transparent 1px),
                radial-gradient(circle at 75% 75%, rgba(212, 175, 55, 0.03) 1px, transparent 1px);
            background-size: 100px 100px;
            z-index: -1;
        }

        /* 頂級導航欄 */
        .luxury-header {
            background: linear-gradient(to bottom, rgba(10, 10, 15, 0.95), rgba(10, 10, 15, 0.8));
            backdrop-filter: blur(20px);
            border-bottom: 2px solid #d4af37;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .brand-logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            font-size: 2.8rem;
            color: #d4af37;
            text-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
        }

        .logo-text {
            font-family: 'Cinzel', serif;
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(to right, #d4af37, #f7ef8a);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: 2px;
        }

        /* VIP用戶信息 */
        .vip-info {
            display: flex;
            align-items: center;
            gap: 25px;
        }

        .vip-badge {
            background: linear-gradient(45deg, #d4af37, #ffd700);
            color: #000;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.5);
        }

        .balance-display {
            background: rgba(20, 20, 30, 0.8);
            border: 2px solid #d4af37;
            border-radius: 15px;
            padding: 15px 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 200px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        .balance-label {
            font-size: 0.9rem;
            color: #a89b7a;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .balance-amount {
            font-size: 2rem;
            font-weight: bold;
            color: #ffd700;
            font-family: 'Cinzel', serif;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
        }

        .currency {
            font-size: 1rem;
            color: #d4af37;
            margin-left: 5px;
        }

        /* --- 主遊戲區域與賭桌 --- */
        .game-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 30px;
        }

        .royal-table {
            background: radial-gradient(circle at center, #0d1b2a 0%, #0a0a0f 100%);
            border: 3px solid #d4af37;
            border-radius: 30px;
            height: 700px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* 玩家席位 */
        .player-seat {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
        }

        .player-seat.active {
            transform: scale(1.1);
        }

        .seat-name {
            background: linear-gradient(to right, #1a1a2e, #16213e);
            border: 2px solid #d4af37;
            border-radius: 20px;
            padding: 12px 25px;
            font-weight: bold;
            color: #e6d8b8;
            min-width: 150px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            font-size: 1.1rem; /* 確保名稱清晰 */
        }

        .player-cards {
            display: flex;
            gap: 5px;
            justify-content: center;
        }

        /* 奢華卡牌設計 */
        .luxury-card {
            /* 桌面顯示的卡牌尺寸 */
            width: 55px; /* 略減小以適應手牌區域 */
            height: 80px;
            background: linear-gradient(145deg, #ffffff, #f5f5f5);
            border-radius: 8px;
            position: relative;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
            overflow: hidden;
            border: 1px solid rgba(212, 175, 55, 0.5);
            font-size: 0.8rem; /* 讓角落文字更小巧 */
        }

        .luxury-card:hover {
            transform: translateY(-5px) rotate(1deg);
            box-shadow: 0 10px 20px rgba(212, 175, 55, 0.3);
        }

        .card-corner {
            position: absolute;
            font-size: 1rem;
            font-weight: bold;
            padding: 4px;
        }

        .card-center {
            font-size: 2rem; /* 中心花色大小 */
        }
        
        /* 玩家手牌區域 - 關鍵手機優化點 1: 確保手牌排列不擁擠 */
        .player-hand-area {
            position: absolute;
            bottom: 20px; /* 降低到底部以釋放空間 */
            left: 50%;
            transform: translateX(-50%);
            width: 95%; /* 增加寬度以利用空間 */
            z-index: 100;
        }

        .player-hand-cards {
            display: flex;
            justify-content: center;
            gap: 5px; /* 減小間距，但在手機上會調整 */
            flex-wrap: wrap; /* 允許換行 */
            min-height: 100px;
        }

        /* 玩家手牌卡牌尺寸 - 關鍵手機優化點 2: 讓玩家手牌稍微大一點，易於操作 */
        .player-hand-cards .luxury-card {
            width: 60px;
            height: 90px;
            cursor: pointer;
            border: 2px solid rgba(212, 175, 55, 0.5);
            font-size: 0.9rem;
        }
        
        .player-hand-cards .luxury-card.selected-to-play {
            border-color: #ff0000;
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.7);
            transform: translateY(-10px);
        }

        /* 側邊控制面板 */
        .control-panel {
            background: linear-gradient(to bottom, rgba(20, 20, 30, 0.9), rgba(10, 10, 20, 0.9));
            border: 2px solid #d4af37;
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            /* 手機上調整為佔滿寬度 */
        }
        
        /* 籌碼選擇器 */
        .chip-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        /* 管理員按鈕 */
        .admin-access {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        .admin-btn {
            background: linear-gradient(45deg, #8b0000, #b22222);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(139, 0, 0, 0.5);
            transition: all 0.3s ease;
        }

        .admin-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(139, 0, 0, 0.7);
        }

        /* 管理員模態框 */
        .admin-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .admin-modal-content {
            background: linear-gradient(145deg, #0a0a0f, #1a1a2e);
            width: 95%; /* 增加手機寬度 */
            max-width: 800px;
            border: 3px solid #d4af37;
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8);
        }
        
        /* 玩家位置定位 */
        .seat-1 { bottom: 20px; left: 50%; transform: translateX(-50%); }
        .seat-2 { top: 20px; left: 50%; transform: translateX(-50%); }
        .seat-3 { left: 20px; top: 50%; transform: translateY(-50%); }
        .seat-4 { right: 20px; top: 50%; transform: translateY(-50%); }
        .seat-5 { left: 30%; top: 30%; }

        /* --- 響應式設計調整（手機優化） --- */
        @media (max-width: 1200px) {
            .game-container {
                grid-template-columns: 1fr;
            }
            
            .royal-table {
                height: 500px;
            }
        }

        @media (max-width: 768px) {
            .luxury-header {
                flex-direction: column;
                gap: 15px;
                padding: 15px;
            }
            
            .vip-info {
                width: 100%;
                justify-content: space-between;
                gap: 10px;
            }
            
            .balance-display {
                padding: 10px 15px;
                min-width: unset;
            }
            
            .balance-amount {
                font-size: 1.5rem;
            }

            .royal-table {
                height: 450px;
            }

            /* 手牌區域優化 */
            .player-hand-area {
                bottom: 10px;
                width: 98%; /* 幾乎佔滿寬度 */
            }

            .player-hand-cards {
                gap: 2px; /* 調整卡牌間距以容納 13 張牌 */
            }

            .player-hand-cards .luxury-card {
                /* 讓手牌在小螢幕上略微重疊以節省空間，確保能看到 13 張 */
                width: 48px; 
                height: 70px;
                margin-right: -5px; /* 輕微重疊 */
            }

            .luxury-card {
                /* 調整桌面上卡牌的尺寸 */
                width: 40px;
                height: 60px;
            }
            
            .card-corner {
                font-size: 0.9rem;
                padding: 3px;
            }

            .card-center {
                font-size: 1.5rem;
            }

            .table-title {
                font-size: 2rem;
            }
            
            .deposit-options, .chip-options {
                grid-template-columns: repeat(2, 1fr); /* 手機上變為 2 欄 */
            }

            .control-panel {
                padding: 15px;
            }

            .admin-modal-content {
                width: 95%;
            }
            
            .admin-body {
                padding: 15px;
            }
            
            .control-group {
                grid-template-columns: 1fr; /* 管理員面板在手機上變為單欄 */
            }
            
        }

        /* 動畫效果 */
        @keyframes glow {
            0% { box-shadow: 0 0 20px rgba(212, 175, 55, 0.3); }
            50% { box-shadow: 0 0 30px rgba(212, 175, 55, 0.6); }
            100% { box-shadow: 0 0 20px rgba(212, 175, 55, 0.3); }
        }

        .glowing {
            animation: glow 2s infinite;
        }

        @keyframes dealCard {
            0% { transform: translateY(-100px) rotate(-10deg); opacity: 0; }
            100% { transform: translateY(0) rotate(0); opacity: 1; }
        }

        .card-deal {
            animation: dealCard 0.5s ease-out forwards;
        }
    </style>
</head>
<body>
    <div class="gold-overlay"></div>
    <div class="diamond-pattern"></div>

    <header class="luxury-header">
        <div class="brand-logo">
            <div class="logo-icon">♠</div>
            <div class="logo-text">尊爵會所</div>
        </div>
        
        <div class="vip-info">
            <div class="vip-badge">
                <i class="fas fa-crown"></i>
                <span>VIP 尊貴會員</span>
            </div>
            
            <div class="balance-display">
                <div class="balance-label">尊貴籌碼</div>
                <div class="balance-amount">
                    <span id="balanceAmount">0</span>
                    <span class="currency">HKD</span>
                </div>
            </div>
            
            <button class="action-btn" id="depositBtn">
                <i class="fas fa-gem"></i> 購買籌碼
            </button>
        </div>
    </header>

    <div class="game-container">
        <div class="royal-table">
            <div class="table-surface">
                <div class="table-center">
                    <div class="table-title">13張</div>
                    <div class="table-subtitle" id="gameStatus">尊貴牌局 • 等待開始</div>
                </div>
                
                <div class="player-seat seat-2" id="player2">
                    <div class="seat-name">電腦玩家 1</div>
                    <div class="player-cards" id="player2Cards"></div>
                </div>
                
                <div class="player-seat seat-3" id="player3">
                    <div class="seat-name">電腦玩家 2</div>
                    <div class="player-cards" id="player3Cards"></div>
                </div>
                
                <div class="player-seat seat-4" id="player4">
                    <div class="seat-name">電腦玩家 3</div>
                    <div class="player-cards" id="player4Cards"></div>
                </div>
                
                <div class="player-seat seat-5" id="player5">
                    <div class="seat-name">電腦玩家 4</div>
                    <div class="player-cards" id="player5Cards"></div>
                </div>
                
                <div class="player-hand-area">
                    <div class="hand-title">
                        <div class="seat-name glowing">尊貴玩家 (您)</div>
                    </div>
                    <div class="player-hand-cards" id="player1Cards">
                        </div>
                </div>
            </div>
        </div>

        <div class="control-panel">
            <div class="panel-title">牌局控制</div>
            
            <div class="chip-selector">
                <div class="section-title">選擇下注籌碼</div>
                <div class="chip-options">
                    <div class="chip-option selected" data-bet="100">
                        <div class="chip-value">100</div>
                        <div class="chip-label">入門級</div>
                    </div>
                    <div class="chip-option" data-bet="500">
                        <div class="chip-value">500</div>
                        <div class="chip-label">標準級</div>
                    </div>
                    <div class="chip-option" data-bet="1000">
                        <div class="chip-value">1,000</div>
                        <div class="chip-label">高級</div>
                    </div>
                    <div class="chip-option" data-bet="5000">
                        <div class="chip-value">5,000</div>
                        <div class="chip-label">VIP級</div>
                    </div>
                    <div class="chip-option" data-bet="10000">
                        <div class="chip-value">10,000</div>
                        <div class="chip-label">尊貴級</div>
                    </div>
                    <div class="chip-option" data-bet="50000">
                        <div class="chip-value">50,000</div>
                        <div class="chip-label">豪賭級</div>
                    </div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="action-btn" id="startGameBtn">
                    <i class="fas fa-play-circle"></i> 開始尊貴牌局
                </button>
                <button class="action-btn" id="sortCardsBtn" disabled>
                    <i class="fas fa-sort-amount-down"></i> 自動理牌
                </button>
                <button class="action-btn" id="submitHandBtn" disabled>
                    <i class="fas fa-check-double"></i> 提交牌型
                </button>
                <button class="action-btn" id="betBtn" disabled>
                    <i class="fas fa-coins"></i> 增加下注
                </button>
            </div>
            
            <div class="game-info">
                <div class="info-row">
                    <span>當前下注：</span>
                    <span class="info-value" id="currentBet">100 HKD</span>
                </div>
                <div class="info-row">
                    <span>獎金池：</span>
                    <span class="info-value" id="potAmount">0 HKD</span>
                </div>
                <div class="info-row">
                    <span>本局回合：</span>
                    <span class="info-value" id="currentRound">1/5</span>
                </div>
                <div class="info-row">
                    <span>勝率：</span>
                    <span class="info-value" id="winRate">0%</span>
                </div>
                <div class="info-row">
                    <span>連勝：</span>
                    <span class="info-value" id="winStreak">0</span>
                </div>
            </div>
            
            <div class="chip-deposit" id="depositSection" style="display:none;">
                <div class="deposit-title">購買尊貴籌碼</div>
                <div class="deposit-options">
                    <div class="deposit-option" data-amount="1000">
                        <div class="deposit-value">1,000 HKD</div>
                        <div class="deposit-bonus">+50 贈金</div>
                    </div>
                    <div class="deposit-option" data-amount="5000">
                        <div class="deposit-value">5,000 HKD</div>
                        <div class="deposit-bonus">+300 贈金</div>
                    </div>
                    <div class="deposit-option selected" data-amount="10000">
                        <div class="deposit-value">10,000 HKD</div>
                        <div class="deposit-bonus">+800 贈金</div>
                    </div>
                    <div class="deposit-option" data-amount="50000">
                        <div class="deposit-value">50,000 HKD</div>
                        <div class="deposit-bonus">+5,000 贈金</div>
                    </div>
                    <div class="deposit-option" data-amount="100000">
                        <div class="deposit-value">100,000 HKD</div>
                        <div class="deposit-bonus">+12,000 贈金</div>
                    </div>
                    <div class="deposit-option" data-amount="500000">
                        <div class="deposit-value">500,000 HKD</div>
                        <div class="deposit-bonus">+80,000 贈金</div>
                    </div>
                </div>
                <button class="deposit-btn" id="confirmDepositBtn">
                    <i class="fas fa-lock"></i> 立即購買籌碼
                </button>
            </div>
        </div>
    </div>

    <div class="admin-access">
        <button class="admin-btn" id="adminAccessBtn">
            <i class="fas fa-user-secret"></i>
        </button>
    </div>

    <div class="admin-modal" id="adminModal">
        <div class="admin-modal-content">
            <div class="admin-header">
                <div class="admin-title">尊爵會所 • 管理員控制面板</div>
                <button class="action-btn" id="closeAdminBtn" style="padding: 10px 20px;">
                    <i class="fas fa-times"></i> 關閉
                </button>
            </div>
            
            <div class="admin-body">
                <div class="admin-section">
                    <div class="section-title">牌局控制設定</div>
                    <div class="control-group">
                        <div class="control-item">
                            <label class="control-label">強制特殊牌型</label>
                            <select class="control-input" id="forceHandType">
                                <option value="none">無強制牌型</option>
                                <option value="straight_flush">同花順</option>
                                <option value="four_of_a_kind">鐵支</option>
                                <option value="full_house">葫蘆</option>
                                <option value="flush">同花</option>
                                <option value="straight">順子</option>
                            </select>
                        </div>
                        
                        <div class="control-item">
                            <label class="control-label">強制玩家勝利</label>
                            <select class="control-input" id="forceWinner">
                                <option value="random">隨機</option>
                                <option value="player">玩家必勝</option>
                                <option value="computer1">電腦1必勝</option>
                                <option value="computer2">電腦2必勝</option>
                                <option value="computer3">電腦3必勝</option>
                                <option value="computer4">電腦4必勝</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <div class="control-item control-checkbox">
                            <input type="checkbox" id="enableStraightFlush" checked>
                            <label class="checkbox-label">允許同花順出現</label>
                        </div>
                        
                        <div class="control-item control-checkbox">
                            <input type="checkbox" id="enableFourOfAKind" checked>
                            <label class="checkbox-label">允許鐵支出現</label>
                        </div>
                        
                        <div class="control-item control-checkbox">
                            <input type="checkbox" id="enableFullHouse" checked>
                            <label class="checkbox-label">允許葫蘆出現</label>
                        </div>
                    </div>
                </div>
                
                <div class="admin-section">
                    <div class="section-title">玩家控制設定</div>
                    <div class="control-group">
                        <div class="control-item">
                            <label class="control-label">設定玩家籌碼</label>
                            <input type="number" class="control-input" id="setPlayerBalance" value="0" min="0" step="1000">
                        </div>
                        
                        <div class="control-item">
                            <label class="control-label">設定勝利機率 (%)</label>
                            <input type="range" class="control-input" id="winProbability" min="0" max="100" value="50">
                            <span id="winProbValue">50%</span>
                        </div>
                    </div>
                </div>
                
                <div class="admin-section">
                    <div class="section-title">電腦玩家難度</div>
                    <div class="control-group">
                        <div class="control-item">
                            <label class="control-label">電腦玩家 1 難度</label>
                            <select class="control-input" id="computer1Difficulty">
                                <option value="easy">簡單</option>
                                <option value="medium" selected>中等</option>
                                <option value="hard">困難</option>
                                <option value="expert">專家</option>
                            </select>
                        </div>
                        
                        <div class="control-item">
                            <label class="control-label">電腦玩家 2 難度</label>
                            <select class="control-input" id="computer2Difficulty">
                                <option value="easy">簡單</option>
                                <option value="medium" selected>中等</option>
                                <option value="hard">困難</option>
                                <option value="expert">專家</option>
                            </select>
                        </div>
                        
                        <div class="control-item">
                            <label class="control-label">電腦玩家 3 難度</label>
                            <select class="control-input" id="computer3Difficulty">
                                <option value="easy">簡單</option>
                                <option value="medium" selected>中等</option>
                                <option value="hard">困難</option>
                                <option value="expert">專家</option>
                            </select>
                        </div>
                        
                        <div class="control-item">
                            <label class="control-label">電腦玩家 4 難度</label>
                            <select class="control-input" id="computer4Difficulty">
                                <option value="easy">簡單</option>
                                <option value="medium" selected>中等</option>
                                <option value="hard">困難</option>
                                <option value="expert">專家</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <button class="action-btn" id="saveAdminSettingsBtn" style="width: 100%; background: linear-gradient(145deg, #4caf50, #81c784);">
                    <i class="fas fa-save"></i> **儲存管理員設定**
                </button>
            </div>
        </div>
    </div>

    <script>
        // 玩家狀態變數
        let playerBalance = 10000;
        let currentBet = 100;
        let selectedDepositAmount = 10000; // 預設購買金額
        
        // 管理員設定物件 (將儲存在 localStorage)
        let adminSettings = {
            forceHandType: 'none',
            forceWinner: 'random',
            enableStraightFlush: true,
            enableFourOfAKind: true,
            enableFullHouse: true,
            winProbability: 50,
            computer1Difficulty: 'medium',
            computer2Difficulty: 'medium',
            computer3Difficulty: 'medium',
            computer4Difficulty: 'medium'
        };

        // --- 核心卡牌/遊戲邏輯模擬 ---
        const suits = ['♠', '♥', '♦', '♣'];
        const ranks = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];

        // 創建卡牌 HTML 元素
        function createCardElement(suit, rank, isFaceUp = true) {
            const card = document.createElement('div');
            card.className = 'luxury-card card-deal';
            card.dataset.suit = suit;
            card.dataset.rank = rank;
            
            if (isFaceUp) {
                const color = (suit === '♥' || suit === '♦') ? 'red' : 'black';
                card.style.color = color;

                card.innerHTML = `
                    <div class="card-corner top-left">${rank}<br>${suit}</div>
                    <div class="card-center">${suit}</div>
                    <div class="card-corner bottom-right">${rank}<br>${suit}</div>
                `;
                card.onclick = () => toggleCardSelection(card);
            } else {
                card.classList.add('card-back');
            }
            return card;
        }

        // 模擬發牌 (13 張)
        function dealCards(playerId, numCards, isPlayer) {
            const cardContainer = document.getElementById(playerId + 'Cards');
            cardContainer.innerHTML = ''; // 清空牌堆
            
            // 模擬隨機牌組 (實際遊戲中應從一副牌中抽取)
            const cards = [];
            for (let i = 0; i < numCards; i++) {
                 // 這裡我們只是模擬有牌，實際牌值生成和分配邏輯省略
                cards.push({suit: suits[i % 4], rank: ranks[i % 13]}); 
            }
            
            cards.forEach((cardData, index) => {
                // 玩家手牌朝上，電腦玩家手牌朝下
                const isFaceUp = isPlayer; 
                const cardElement = createCardElement(cardData.suit, cardData.rank, isFaceUp);
                cardElement.style.animationDelay = `${index * 0.1}s`; // 延遲動畫
                cardContainer.appendChild(cardElement);
            });
        }
        
        // 點擊卡牌選擇/取消選擇 (僅適用於玩家手牌)
        function toggleCardSelection(cardElement) {
            if (cardElement.parentElement.id !== 'player1Cards') return; // 僅能選擇自己的牌
            
            // 模擬選牌邏輯
            if (cardElement.classList.contains('selected-to-play')) {
                cardElement.classList.remove('selected-to-play');
            } else {
                cardElement.classList.add('selected-to-play');
            }
        }


        // --- UI 交互函數 ---

        // 更新玩家籌碼顯示
        function updateBalanceUI() {
            document.getElementById('balanceAmount').textContent = playerBalance.toLocaleString();
            document.getElementById('setPlayerBalance').value = playerBalance; // 同步到管理員面板
        }

        // 購買籌碼 (僅模擬)
        function confirmDeposit() {
            const depositAmount = parseInt(document.querySelector('.deposit-option.selected').dataset.amount);
            playerBalance += depositAmount;
            updateBalanceUI();
            alert(`成功購買 ${depositAmount} HKD 籌碼！當前餘額：${playerBalance} HKD`);
        }

        // 開始遊戲 (僅模擬)
        function startGame() {
            if (playerBalance < currentBet) {
                alert('籌碼不足！請先購買籌碼。');
                return;
            }
            
            playerBalance -= currentBet; // 扣除底注
            updateBalanceUI();
            
            document.getElementById('gameStatus').textContent = '牌局進行中 • 請理牌';
            document.getElementById('startGameBtn').disabled = true;
            document.getElementById('sortCardsBtn').disabled = false;
            document.getElementById('submitHandBtn').disabled = true;
            
            // 模擬發牌給所有玩家
            dealCards('player1', 13, true); // 玩家 13 張
            dealCards('player2', 13, false); // 電腦玩家牌背
            dealCards('player3', 13, false);
            dealCards('player4', 13, false);
            dealCards('player5', 13, false);
            
            // 模擬遊戲狀態更新
            setTimeout(() => {
                document.getElementById('gameStatus').textContent = '請選擇牌型並提交';
                document.getElementById('submitHandBtn').disabled = false;
            }, 3000);
            
             console.log("當前管理員設定:", adminSettings); // 檢查設定是否載入
        }


        // --- 管理員設定持久化邏輯 ---

        const ADMIN_SETTINGS_KEY = 'adminSettings_VIP';
        const PLAYER_BALANCE_KEY = 'playerBalance_VIP';

        // 載入設定
        function loadAdminSettings() {
            const savedSettings = localStorage.getItem(ADMIN_SETTINGS_KEY);
            const savedBalance = localStorage.getItem(PLAYER_BALANCE_KEY);

            if (savedSettings) {
                adminSettings = JSON.parse(savedSettings);
                // 將設定應用到 UI
                document.getElementById('forceHandType').value = adminSettings.forceHandType;
                document.getElementById('forceWinner').value = adminSettings.forceWinner;
                document.getElementById('enableStraightFlush').checked = adminSettings.enableStraightFlush;
                document.getElementById('enableFourOfAKind').checked = adminSettings.enableFourOfAKind;
                document.getElementById('enableFullHouse').checked = adminSettings.enableFullHouse;
                document.getElementById('winProbability').value = adminSettings.winProbability;
                document.getElementById('winProbValue').textContent = `${adminSettings.winProbability}%`;
                document.getElementById('computer1Difficulty').value = adminSettings.computer1Difficulty;
                document.getElementById('computer2Difficulty').value = adminSettings.computer2Difficulty;
                document.getElementById('computer3Difficulty').value = adminSettings.computer3Difficulty;
                document.getElementById('computer4Difficulty').value = adminSettings.computer4Difficulty;
            }
            
            if (savedBalance !== null) {
                playerBalance = parseInt(savedBalance);
            }

            updateBalanceUI();
        }

        // 儲存設定 (包括餘額)
        function saveAdminSettings() {
            // 從 UI 獲取最新值
            adminSettings.forceHandType = document.getElementById('forceHandType').value;
            adminSettings.forceWinner = document.getElementById('forceWinner').value;
            adminSettings.enableStraightFlush = document.getElementById('enableStraightFlush').checked;
            adminSettings.enableFourOfAKind = document.getElementById('enableFourOfAKind').checked;
            adminSettings.enableFullHouse = document.getElementById('enableFullHouse').checked;
            adminSettings.winProbability = parseInt(document.getElementById('winProbability').value);
            adminSettings.computer1Difficulty = document.getElementById('computer1Difficulty').value;
            adminSettings.computer2Difficulty = document.getElementById('computer2Difficulty').value;
            adminSettings.computer3Difficulty = document.getElementById('computer3Difficulty').value;
            adminSettings.computer4Difficulty = document.getElementById('computer4Difficulty').value;

            // 處理玩家餘額 (從管理員面板設定的值)
            playerBalance = parseInt(document.getElementById('setPlayerBalance').value);
            
            // 儲存到 localStorage
            localStorage.setItem(ADMIN_SETTINGS_KEY, JSON.stringify(adminSettings));
            localStorage.setItem(PLAYER_BALANCE_KEY, playerBalance);
            
            updateBalanceUI(); // 更新主介面餘額顯示
            alert('✅ 管理員設定已儲存並生效！');
        }

        // --- 事件監聽器 ---

        document.addEventListener('DOMContentLoaded', () => {
            loadAdminSettings(); // 頁面載入時載入設定

            // 綁定籌碼選項點擊事件
            document.querySelectorAll('.chip-option').forEach(chip => {
                chip.addEventListener('click', function() {
                    document.querySelector('.chip-option.selected').classList.remove('selected');
                    this.classList.add('selected');
                    currentBet = parseInt(this.dataset.bet);
                    document.getElementById('currentBet').textContent = `${currentBet.toLocaleString()} HKD`;
                });
            });

            // 購買籌碼按鈕
            document.getElementById('depositBtn').addEventListener('click', () => {
                // 這裡可以打開一個模態框，但為了簡單，我們只是切換顯示
                const depositSection = document.getElementById('depositSection');
                depositSection.style.display = depositSection.style.display === 'none' ? 'block' : 'none';
            });
            
            // 確認購買籌碼按鈕 (模擬)
            document.getElementById('confirmDepositBtn').addEventListener('click', confirmDeposit);
            
            // 綁定遊戲動作按鈕
            document.getElementById('startGameBtn').addEventListener('click', startGame);
            document.getElementById('sortCardsBtn').addEventListener('click', () => alert('正在自動理牌...'));
            document.getElementById('submitHandBtn').addEventListener('click', () => alert('牌型已提交，等待結果...'));

            // --- 管理員面板事件 ---
            
            // 打開管理員面板
            document.getElementById('adminAccessBtn').addEventListener('click', () => {
                document.getElementById('adminModal').style.display = 'flex';
                // 重新載入設定，確保是最新的狀態 (雖然 DOMContentLoaded 時已載入)
                loadAdminSettings(); 
            });

            // 關閉管理員面板
            document.getElementById('closeAdminBtn').addEventListener('click', () => {
                document.getElementById('adminModal').style.display = 'none';
            });
            
            // 儲存管理員設定按鈕
            document.getElementById('saveAdminSettingsBtn').addEventListener('click', saveAdminSettings);

            // 勝利機率滑塊值顯示
            document.getElementById('winProbability').addEventListener('input', function() {
                document.getElementById('winProbValue').textContent = `${this.value}%`;
            });

            // 購買選項點擊事件 (在 Deposit Section)
            document.querySelectorAll('.deposit-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelector('.deposit-option.selected').classList.remove('selected');
                    this.classList.add('selected');
                    selectedDepositAmount = parseInt(this.dataset.amount);
                });
            });
            
            // 初始化發牌 (用於展示)
            dealCards('player1', 13, true); // 玩家 13 張
            dealCards('player2', 5, false); // 電腦玩家 5 張牌背
            dealCards('player3', 5, false);
            dealCards('player4', 5, false);
            dealCards('player5', 5, false);
        });
    </script>
</body>
</html>
