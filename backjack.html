<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>皇家21點賭場 | 香港</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #0c2c4d 0%, #1a1a2e 100%);
            color: #f5f5f5;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* 頁首樣式 */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 30px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-icon {
            font-size: 2.5rem;
            color: #f8c555;
        }
        
        .logo-text {
            font-family: 'Playfair Display', serif;
            font-size: 2.2rem;
            font-weight: 700;
            background: linear-gradient(to right, #f8c555, #ff9d00);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .balance {
            background: rgba(0, 0, 0, 0.4);
            padding: 12px 25px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.2rem;
            border: 1px solid rgba(248, 197, 85, 0.3);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .balance-amount {
            color: #f8c555;
            font-weight: 700;
        }
        
        .balance-icon {
            color: #f8c555;
        }
        
        /* 遊戲區域樣式 */
        .game-container {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .game-area {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }
        
        .game-title {
            text-align: center;
            margin-bottom: 30px;
            font-size: 1.8rem;
            color: #fff;
            font-weight: 600;
        }
        
        .cards-area {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            min-height: 250px;
        }
        
        .player-section, .dealer-section {
            flex: 1;
            padding: 20px;
        }
        
        .section-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: #f8c555;
            text-align: center;
            font-weight: 600;
        }
        
        .cards-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            min-height: 160px;
        }
        
        .card {
            width: 100px;
            height: 140px;
            background: #fff;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #222;
            font-weight: 700;
            font-size: 1.5rem;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
            position: relative;
            transition: transform 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card-red {
            color: #d32f2f;
        }
        
        .card-back {
            background: linear-gradient(45deg, #1a237e, #283593);
            color: white;
            font-size: 2rem;
        }
        
        .card-value {
            font-size: 2.2rem;
            margin-bottom: 5px;
        }
        
        .card-suit {
            font-size: 1.8rem;
        }
        
        .score {
            text-align: center;
            font-size: 1.3rem;
            margin-top: 15px;
            color: #fff;
            font-weight: 600;
        }
        
        /* 遊戲控制按鈕 */
        .game-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        
        .game-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .hit-btn {
            background: linear-gradient(to right, #4CAF50, #2E7D32);
            color: white;
        }
        
        .stand-btn {
            background: linear-gradient(to right, #f44336, #c62828);
            color: white;
        }
        
        .deal-btn {
            background: linear-gradient(to right, #2196F3, #1565C0);
            color: white;
        }
        
        .game-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        .game-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        /* 籌碼區域樣式 */
        .chips-area {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }
        
        .chips-title {
            font-size: 1.5rem;
            margin-bottom: 25px;
            color: #fff;
            font-weight: 600;
            text-align: center;
        }
        
        .bet-amount {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            text-align: center;
        }
        
        .bet-label {
            font-size: 1rem;
            color: #aaa;
            margin-bottom: 10px;
        }
        
        .bet-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: #f8c555;
        }
        
        .chips-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .chip {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: 700;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
            margin: 0 auto;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
            border: 4px solid rgba(255, 255, 255, 0.2);
        }
        
        .chip:hover {
            transform: scale(1.1);
        }
        
        .chip-10 { background: linear-gradient(135deg, #4CAF50, #2E7D32); }
        .chip-25 { background: linear-gradient(135deg, #2196F3, #1565C0); }
        .chip-50 { background: linear-gradient(135deg, #9C27B0, #6A1B9A); }
        .chip-100 { background: linear-gradient(135deg, #f44336, #c62828); }
        .chip-500 { background: linear-gradient(135deg, #FF9800, #EF6C00); }
        .chip-1000 { background: linear-gradient(135deg, #795548, #4E342E); }
        
        .chip-value {
            color: white;
            font-size: 1.4rem;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
        }
        
        /* 支付區域樣式 */
        .payment-area {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            margin-top: 30px;
        }
        
        .payment-title {
            font-size: 1.5rem;
            margin-bottom: 25px;
            color: #fff;
            font-weight: 600;
            text-align: center;
        }
        
        .payment-options {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .payment-btn {
            flex: 1;
            padding: 18px;
            border-radius: 12px;
            border: none;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        
        .alipay-btn {
            background: linear-gradient(to right, #009FE3, #0077B5);
            color: white;
        }
        
        .wechat-btn {
            background: linear-gradient(to right, #07C160, #05A84F);
            color: white;
        }
        
        .payment-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .payment-amount {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .amount-option {
            flex: 1;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .amount-option:hover {
            background: rgba(248, 197, 85, 0.2);
        }
        
        .amount-option.selected {
            background: rgba(248, 197, 85, 0.3);
            border-color: #f8c555;
        }
        
        .amount-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #f8c555;
        }
        
        .amount-label {
            font-size: 0.9rem;
            color: #aaa;
            margin-top: 5px;
        }
        
        .deposit-btn {
            width: 100%;
            padding: 18px;
            border-radius: 50px;
            border: none;
            background: linear-gradient(to right, #f8c555, #ff9d00);
            color: #1a1a2e;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .deposit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(248, 197, 85, 0.4);
        }
        
        /* 遊戲狀態訊息 */
        .game-status {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            font-weight: 600;
            font-size: 1.2rem;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .win-message {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
            border: 1px solid rgba(76, 175, 80, 0.5);
        }
        
        .lose-message {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
            border: 1px solid rgba(244, 67, 54, 0.5);
        }
        
        .info-message {
            background: rgba(33, 150, 243, 0.2);
            color: #2196F3;
            border: 1px solid rgba(33, 150, 243, 0.5);
        }
        
        /* 響應式設計 */
        @media (max-width: 1100px) {
            .game-container {
                grid-template-columns: 1fr;
            }
            
            .cards-area {
                flex-direction: column;
                gap: 40px;
            }
        }
        
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 20px;
            }
            
            .chips-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .payment-options {
                flex-direction: column;
            }
        }
        
        /* 動畫效果 */
        @keyframes cardDraw {
            0% { transform: translateY(-30px) rotateY(90deg); opacity: 0; }
            100% { transform: translateY(0) rotateY(0); opacity: 1; }
        }
        
        .card-drawn {
            animation: cardDraw 0.5s ease-out;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease-in-out;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-crown"></i>
                </div>
                <div class="logo-text">皇家21點</div>
            </div>
            
            <div class="user-info">
                <div class="balance">
                    <i class="fas fa-coins balance-icon"></i>
                    <span>餘額: <span class="balance-amount" id="balanceAmount">10,000</span> 港元</span>
                </div>
            </div>
        </header>
        
        <div class="game-container">
            <div class="game-area">
                <h2 class="game-title">21點遊戲桌</h2>
                
                <div class="cards-area">
                    <div class="dealer-section">
                        <h3 class="section-title">莊家</h3>
                        <div class="cards-container" id="dealerCards">
                            <!-- 莊家牌會在這裡動態生成 -->
                        </div>
                        <div class="score" id="dealerScore">點數: 0</div>
                    </div>
                    
                    <div class="player-section">
                        <h3 class="section-title">玩家</h3>
                        <div class="cards-container" id="playerCards">
                            <!-- 玩家牌會在這裡動態生成 -->
                        </div>
                        <div class="score" id="playerScore">點數: 0</div>
                    </div>
                </div>
                
                <div class="game-status info-message" id="gameStatus">
                    請下注並開始新遊戲
                </div>
                
                <div class="game-controls">
                    <button class="game-btn hit-btn" id="hitBtn" disabled>
                        <i class="fas fa-plus-circle"></i> 要牌
                    </button>
                    <button class="game-btn stand-btn" id="standBtn" disabled>
                        <i class="fas fa-hand-paper"></i> 停牌
                    </button>
                    <button class="game-btn deal-btn" id="dealBtn">
                        <i class="fas fa-play"></i> 開始遊戲
                    </button>
                </div>
            </div>
            
            <div class="chips-area">
                <h3 class="chips-title">籌碼區</h3>
                
                <div class="bet-amount">
                    <div class="bet-label">當前下注</div>
                    <div class="bet-value" id="currentBet">0</div>
                </div>
                
                <div class="chips-container">
                    <div class="chip chip-10" data-value="10">
                        <div class="chip-value">10</div>
                    </div>
                    <div class="chip chip-25" data-value="25">
                        <div class="chip-value">25</div>
                    </div>
                    <div class="chip chip-50" data-value="50">
                        <div class="chip-value">50</div>
                    </div>
                    <div class="chip chip-100" data-value="100">
                        <div class="chip-value">100</div>
                    </div>
                    <div class="chip chip-500" data-value="500">
                        <div class="chip-value">500</div>
                    </div>
                    <div class="chip chip-1000" data-value="1000">
                        <div class="chip-value">1000</div>
                    </div>
                </div>
                
                <div class="game-controls">
                    <button class="game-btn" id="clearBetBtn" style="background: linear-gradient(to right, #9E9E9E, #616161); color: white;">
                        <i class="fas fa-times-circle"></i> 清除下注
                    </button>
                    <button class="game-btn" id="maxBetBtn" style="background: linear-gradient(to right, #f8c555, #ff9d00); color: #1a1a2e;">
                        <i class="fas fa-chart-line"></i> 最大下注
                    </button>
                </div>
            </div>
        </div>
        
        <div class="payment-area">
            <h3 class="payment-title">快速充值</h3>
            
            <div class="payment-options">
                <button class="payment-btn alipay-btn" id="alipayBtn">
                    <i class="fab fa-alipay"></i> 支付寶
                </button>
                <button class="payment-btn wechat-btn" id="wechatBtn">
                    <i class="fab fa-weixin"></i> 微信支付
                </button>
            </div>
            
            <div class="payment-amount">
                <div class="amount-option" data-amount="500">
                    <div class="amount-value">500 港元</div>
                    <div class="amount-label">新手推薦</div>
                </div>
                <div class="amount-option" data-amount="1000">
                    <div class="amount-value">1,000 港元</div>
                    <div class="amount-label">熱門選擇</div>
                </div>
                <div class="amount-option selected" data-amount="5000">
                    <div class="amount-value">5,000 港元</div>
                    <div class="amount-label">尊貴玩家</div>
                </div>
                <div class="amount-option" data-amount="10000">
                    <div class="amount-value">10,000 港元</div>
                    <div class="amount-label">高額玩家</div>
                </div>
            </div>
            
            <button class="deposit-btn" id="depositBtn">
                <i class="fas fa-credit-card"></i> 立即充值
            </button>
        </div>
    </div>

    <script>
        // 遊戲狀態變量
        let balance = 10000;
        let currentBet = 0;
        let gameActive = false;
        let playerCards = [];
        let dealerCards = [];
        let playerScore = 0;
        let dealerScore = 0;
        let selectedPaymentMethod = 'alipay';
        let selectedAmount = 5000;
        
        // DOM 元素
        const balanceElement = document.getElementById('balanceAmount');
        const currentBetElement = document.getElementById('currentBet');
        const playerCardsElement = document.getElementById('playerCards');
        const dealerCardsElement = document.getElementById('dealerCards');
        const playerScoreElement = document.getElementById('playerScore');
        const dealerScoreElement = document.getElementById('dealerScore');
        const gameStatusElement = document.getElementById('gameStatus');
        const hitBtn = document.getElementById('hitBtn');
        const standBtn = document.getElementById('standBtn');
        const dealBtn = document.getElementById('dealBtn');
        const clearBetBtn = document.getElementById('clearBetBtn');
        const maxBetBtn = document.getElementById('maxBetBtn');
        const chips = document.querySelectorAll('.chip');
        const amountOptions = document.querySelectorAll('.amount-option');
        const alipayBtn = document.getElementById('alipayBtn');
        const wechatBtn = document.getElementById('wechatBtn');
        const depositBtn = document.getElementById('depositBtn');
        
        // 初始化遊戲
        function initGame() {
            updateBalanceDisplay();
            updateBetDisplay();
            resetGameState();
            renderEmptyCards();
        }
        
        // 更新餘額顯示
        function updateBalanceDisplay() {
            balanceElement.textContent = balance.toLocaleString('en-US');
        }
        
        // 更新下注顯示
        function updateBetDisplay() {
            currentBetElement.textContent = currentBet.toLocaleString('en-US');
        }
        
        // 重置遊戲狀態
        function resetGameState() {
            playerCards = [];
            dealerCards = [];
            playerScore = 0;
            dealerScore = 0;
            gameActive = false;
            
            // 禁用遊戲按鈕，除非有下注
            hitBtn.disabled = true;
            standBtn.disabled = true;
            dealBtn.disabled = currentBet === 0;
            
            // 更新遊戲狀態訊息
            if (currentBet === 0) {
                gameStatusElement.textContent = "請下注並開始新遊戲";
                gameStatusElement.className = "game-status info-message";
            } else {
                gameStatusElement.textContent = "已下注 " + currentBet.toLocaleString('en-US') + " 港元，點擊開始遊戲";
                gameStatusElement.className = "game-status info-message";
            }
        }
        
        // 渲染空牌桌
        function renderEmptyCards() {
            playerCardsElement.innerHTML = '<div class="card card-back"><i class="fas fa-question"></i></div>';
            dealerCardsElement.innerHTML = '<div class="card card-back"><i class="fas fa-question"></i></div>';
            
            playerScoreElement.textContent = "點數: 0";
            dealerScoreElement.textContent = "點數: 0";
        }
        
        // 創建牌組
        function createDeck() {
            const suits = ['♠', '♥', '♣', '♦'];
            const values = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
            const deck = [];
            
            for (let suit of suits) {
                for (let value of values) {
                    deck.push({ suit, value });
                }
            }
            
            // 洗牌
            return shuffleDeck(deck);
        }
        
        // 洗牌
        function shuffleDeck(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
            return deck;
        }
        
        // 計算手牌點數
        function calculateScore(cards) {
            let score = 0;
            let aces = 0;
            
            for (let card of cards) {
                if (card.value === 'A') {
                    aces += 1;
                    score += 11;
                } else if (['J', 'Q', 'K'].includes(card.value)) {
                    score += 10;
                } else {
                    score += parseInt(card.value);
                }
            }
            
            // 處理A牌
            while (score > 21 && aces > 0) {
                score -= 10;
                aces -= 1;
            }
            
            return score;
        }
        
        // 渲染牌
        function renderCards() {
            // 渲染玩家牌
            playerCardsElement.innerHTML = '';
            playerScore = calculateScore(playerCards);
            
            playerCards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'card card-drawn';
                if (card.suit === '♥' || card.suit === '♦') {
                    cardElement.classList.add('card-red');
                }
                
                cardElement.innerHTML = `
                    <div class="card-value">${card.value}</div>
                    <div class="card-suit">${card.suit}</div>
                `;
                
                // 添加延遲動畫
                cardElement.style.animationDelay = `${index * 0.2}s`;
                playerCardsElement.appendChild(cardElement);
            });
            
            playerScoreElement.textContent = `點數: ${playerScore}`;
            
            // 渲染莊家牌
            dealerCardsElement.innerHTML = '';
            dealerScore = calculateScore(dealerCards);
            
            dealerCards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                
                // 第一張牌對玩家隱藏
                if (index === 0 && gameActive) {
                    cardElement.className = 'card card-back';
                    cardElement.innerHTML = `<i class="fas fa-question"></i>`;
                } else {
                    cardElement.className = 'card card-drawn';
                    if (card.suit === '♥' || card.suit === '♦') {
                        cardElement.classList.add('card-red');
                    }
                    
                    cardElement.innerHTML = `
                        <div class="card-value">${card.value}</div>
                        <div class="card-suit">${card.suit}</div>
                    `;
                }
                
                cardElement.style.animationDelay = `${index * 0.2}s`;
                dealerCardsElement.appendChild(cardElement);
            });
            
            // 顯示莊家分數（遊戲進行中時隱藏第一張牌的分數）
            if (gameActive) {
                const visibleDealerCards = dealerCards.slice(1);
                const visibleDealerScore = calculateScore(visibleDealerCards);
                dealerScoreElement.textContent = `點數: ${visibleDealerScore} + ?`;
            } else {
                dealerScoreElement.textContent = `點數: ${dealerScore}`;
            }
        }
        
        // 開始新遊戲
        function startGame() {
            if (currentBet === 0 || balance < currentBet) {
                gameStatusElement.textContent = "下注金額不足，請調整下注";
                gameStatusElement.className = "game-status info-message";
                return;
            }
            
            // 從餘額中扣除下注
            balance -= currentBet;
            updateBalanceDisplay();
            
            // 創建新牌組
            const deck = createDeck();
            
            // 發牌
            playerCards = [deck.pop(), deck.pop()];
            dealerCards = [deck.pop(), deck.pop()];
            
            gameActive = true;
            hitBtn.disabled = false;
            standBtn.disabled = false;
            dealBtn.disabled = true;
            
            // 渲染牌
            renderCards();
            
            // 檢查玩家是否直接黑傑克
            playerScore = calculateScore(playerCards);
            if (playerScore === 21) {
                // 玩家黑傑克，直接結束遊戲
                setTimeout(() => {
                    endGame();
                }, 1000);
            } else {
                gameStatusElement.textContent = "遊戲進行中，請選擇要牌或停牌";
                gameStatusElement.className = "game-status info-message";
            }
        }
        
        // 玩家要牌
        function playerHit() {
            if (!gameActive) return;
            
            const deck = createDeck();
            playerCards.push(deck.pop());
            
            renderCards();
            
            playerScore = calculateScore(playerCards);
            
            if (playerScore > 21) {
                // 玩家爆牌
                gameStatusElement.textContent = "爆牌！您輸了 " + currentBet.toLocaleString('en-US') + " 港元";
                gameStatusElement.className = "game-status lose-message";
                endGame();
            } else if (playerScore === 21) {
                // 玩家21點，自動停牌
                gameStatusElement.textContent = "21點！請等待莊家行動";
                gameStatusElement.className = "game-status info-message";
                setTimeout(dealerTurn, 1000);
            }
        }
        
        // 玩家停牌
        function playerStand() {
            if (!gameActive) return;
            
            hitBtn.disabled = true;
            standBtn.disabled = true;
            
            gameStatusElement.textContent = "您選擇停牌，莊家行動中...";
            gameStatusElement.className = "game-status info-message";
            
            setTimeout(dealerTurn, 1000);
        }
        
        // 莊家回合
        function dealerTurn() {
            // 顯示莊家隱藏的牌
            gameActive = false;
            renderCards();
            
            // 莊家規則：必須要到17點以上
            const deck = createDeck();
            while (dealerScore < 17) {
                dealerCards.push(deck.pop());
                dealerScore = calculateScore(dealerCards);
                renderCards();
            }
            
            // 短暫延遲後結束遊戲
            setTimeout(endGame, 1000);
        }
        
        // 結束遊戲並確定勝負
        function endGame() {
            gameActive = false;
            hitBtn.disabled = true;
            standBtn.disabled = true;
            dealBtn.disabled = false;
            
            playerScore = calculateScore(playerCards);
            dealerScore = calculateScore(dealerCards);
            
            let resultMessage = "";
            let resultClass = "";
            
            // 檢查結果
            if (playerScore > 21) {
                // 玩家爆牌
                resultMessage = "爆牌！您輸了 " + currentBet.toLocaleString('en-US') + " 港元";
                resultClass = "lose-message";
            } else if (dealerScore > 21) {
                // 莊家爆牌，玩家贏
                const winAmount = currentBet * 2;
                balance += winAmount;
                resultMessage = "莊家爆牌！您贏得 " + winAmount.toLocaleString('en-US') + " 港元";
                resultClass = "win-message";
            } else if (playerScore > dealerScore) {
                // 玩家點數高於莊家
                const winAmount = currentBet * 2;
                balance += winAmount;
                resultMessage = "您贏了！獲得 " + winAmount.toLocaleString('en-US') + " 港元";
                resultClass = "win-message";
            } else if (playerScore < dealerScore) {
                // 莊家點數高於玩家
                resultMessage = "您輸了 " + currentBet.toLocaleString('en-US') + " 港元";
                resultClass = "lose-message";
            } else {
                // 平局
                balance += currentBet;
                resultMessage = "平局！退回下注 " + currentBet.toLocaleString('en-US') + " 港元";
                resultClass = "info-message";
            }
            
            // 更新顯示
            updateBalanceDisplay();
            gameStatusElement.textContent = resultMessage;
            gameStatusElement.className = "game-status " + resultClass;
            
            // 重置當前下注
            currentBet = 0;
            updateBetDisplay();
        }
        
        // 下注籌碼
        function placeChip(value) {
            if (gameActive) {
                gameStatusElement.textContent = "遊戲進行中，無法更改下注";
                gameStatusElement.className = "game-status info-message";
                return;
            }
            
            const chipValue = parseInt(value);
            
            if (balance >= chipValue) {
                currentBet += chipValue;
                updateBetDisplay();
                
                // 啟用開始遊戲按鈕
                dealBtn.disabled = false;
                
                gameStatusElement.textContent = "已下注 " + currentBet.toLocaleString('en-US') + " 港元，點擊開始遊戲";
                gameStatusElement.className = "game-status info-message";
            } else {
                gameStatusElement.textContent = "餘額不足，請充值";
                gameStatusElement.className = "game-status lose-message";
            }
        }
        
        // 清除下注
        function clearBet() {
            if (gameActive) {
                gameStatusElement.textContent = "遊戲進行中，無法更改下注";
                gameStatusElement.className = "game-status info-message";
                return;
            }
            
            currentBet = 0;
            updateBetDisplay();
            dealBtn.disabled = true;
            
            gameStatusElement.textContent = "下注已清除，請重新下注";
            gameStatusElement.className = "game-status info-message";
        }
        
        // 最大下注
        function maxBet() {
            if (gameActive) {
                gameStatusElement.textContent = "遊戲進行中，無法更改下注";
                gameStatusElement.className = "game-status info-message";
                return;
            }
            
            // 最大下注為餘額的一半，但不超過5000
            const maxBetAmount = Math.min(Math.floor(balance / 2), 5000);
            
            if (maxBetAmount > 0) {
                currentBet = maxBetAmount;
                updateBetDisplay();
                dealBtn.disabled = false;
                
                gameStatusElement.textContent = "已下注 " + currentBet.toLocaleString('en-US') + " 港元，點擊開始遊戲";
                gameStatusElement.className = "game-status info-message";
            } else {
                gameStatusElement.textContent = "餘額不足，請充值";
                gameStatusElement.className = "game-status lose-message";
            }
        }
        
        // 選擇充值金額
        function selectAmount(amount) {
            selectedAmount = amount;
            
            // 更新UI
            amountOptions.forEach(option => {
                if (parseInt(option.getAttribute('data-amount')) === amount) {
                    option.classList.add('selected');
                } else {
                    option.classList.remove('selected');
                }
            });
        }
        
        // 選擇支付方式
        function selectPaymentMethod(method) {
            selectedPaymentMethod = method;
            
            // 更新UI
            if (method === 'alipay') {
                alipayBtn.classList.add('pulse');
                wechatBtn.classList.remove('pulse');
            } else {
                wechatBtn.classList.add('pulse');
                alipayBtn.classList.remove('pulse');
            }
            
            // 移除脈衝動畫
            setTimeout(() => {
                alipayBtn.classList.remove('pulse');
                wechatBtn.classList.remove('pulse');
            }, 500);
        }
        
        // 充值
        function deposit() {
            balance += selectedAmount;
            updateBalanceDisplay();
            
            gameStatusElement.textContent = "成功充值 " + selectedAmount.toLocaleString('en-US') + " 港元！當前餘額: " + balance.toLocaleString('en-US') + " 港元";
            gameStatusElement.className = "game-status win-message pulse";
            
            // 移除脈衝動畫
            setTimeout(() => {
                gameStatusElement.classList.remove('pulse');
            }, 1000);
        }
        
        // 事件監聽器
        chips.forEach(chip => {
            chip.addEventListener('click', () => {
                placeChip(chip.getAttribute('data-value'));
                chip.classList.add('pulse');
                setTimeout(() => chip.classList.remove('pulse'), 300);
            });
        });
        
        amountOptions.forEach(option => {
            option.addEventListener('click', () => {
                selectAmount(parseInt(option.getAttribute('data-amount')));
            });
        });
        
        // 支付方式選擇
        alipayBtn.addEventListener('click', () => selectPaymentMethod('alipay'));
        wechatBtn.addEventListener('click', () => selectPaymentMethod('wechat'));
        
        // 按鈕事件
        hitBtn.addEventListener('click', playerHit);
        standBtn.addEventListener('click', playerStand);
        dealBtn.addEventListener('click', startGame);
        clearBetBtn.addEventListener('click', clearBet);
        maxBetBtn.addEventListener('click', maxBet);
        depositBtn.addEventListener('click', deposit);
        
        // 初始化遊戲
        initGame();
        
        // 初始選擇支付寶
        selectPaymentMethod('alipay');
    </script>
</body>
</html>
