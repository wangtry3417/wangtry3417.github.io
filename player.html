<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube多媒體播放器</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #e6e6e6;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .container {
            width: 100%;
            max-width: 1000px;
            background-color: rgba(25, 25, 35, 0.9);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        header {
            padding: 25px 30px;
            background: linear-gradient(90deg, #ff0000 0%, #1a1a2e 100%);
            text-align: center;
            border-bottom: 2px solid #ff0000;
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 8px;
            background: linear-gradient(to right, #ff0000, #4cc9f0);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.8;
            font-weight: 300;
        }
        
        .player-container {
            display: flex;
            flex-direction: column;
            padding: 30px;
        }
        
        @media (min-width: 900px) {
            .player-container {
                flex-direction: row;
            }
        }
        
        .media-section {
            flex: 1;
            min-width: 300px;
            margin-bottom: 30px;
        }
        
        @media (min-width: 900px) {
            .media-section {
                margin-bottom: 0;
                margin-right: 30px;
            }
        }
        
        .player-title {
            font-size: 1.5rem;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid #ff0000;
            display: flex;
            align-items: center;
        }
        
        .player-title i {
            margin-right: 10px;
            color: #ff0000;
        }
        
        .video-container {
            width: 100%;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            background-color: #000;
            position: relative;
            padding-top: 56.25%; /* 16:9 寬高比 */
            height: 0;
        }
        
        .youtube-player {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 10px;
        }
        
        .video-placeholder {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: #000;
            color: white;
            text-align: center;
            padding: 20px;
            border-radius: 10px;
        }
        
        .video-placeholder i {
            font-size: 4rem;
            margin-bottom: 15px;
            color: #ff0000;
        }
        
        .video-placeholder p {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .video-placeholder .select-btn {
            margin-top: 15px;
            padding: 10px 20px;
            background-color: #ff0000;
            color: white;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .video-placeholder .select-btn:hover {
            background-color: #cc0000;
        }
        
        .audio-container {
            background-color: rgba(30, 30, 40, 0.8);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .album-art {
            width: 150px;
            height: 150px;
            border-radius: 10px;
            margin: 0 auto 20px;
            overflow: hidden;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.4);
        }
        
        .album-art img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .song-info {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .song-title {
            font-size: 1.4rem;
            margin-bottom: 5px;
            color: #f0f0f0;
        }
        
        .artist {
            font-size: 1.1rem;
            opacity: 0.8;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }
        
        .control-btn {
            background-color: rgba(79, 201, 240, 0.2);
            border: none;
            color: #4cc9f0;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            margin: 0 10px;
            cursor: pointer;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        }
        
        .control-btn:hover {
            background-color: rgba(79, 201, 240, 0.4);
            transform: scale(1.1);
        }
        
        .control-btn:active {
            transform: scale(0.95);
        }
        
        .control-btn.play-pause {
            width: 60px;
            height: 60px;
            background-color: rgba(255, 0, 0, 0.3);
            color: #ff0000;
            font-size: 1.5rem;
        }
        
        .progress-container {
            margin-top: 20px;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            cursor: pointer;
        }
        
        .progress {
            height: 100%;
            width: 0%;
            background: linear-gradient(to right, #ff0000, #4cc9f0);
            border-radius: 4px;
            transition: width 0.1s linear;
        }
        
        .time-display {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .youtube-playlist-section {
            margin-top: 30px;
            padding: 0 30px 30px;
        }
        
        .playlist {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            max-height: 350px;
            overflow-y: auto;
            padding: 10px;
        }
        
        .playlist::-webkit-scrollbar {
            width: 8px;
        }
        
        .playlist::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }
        
        .playlist::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, #ff0000, #4cc9f0);
            border-radius: 4px;
        }
        
        .youtube-item {
            background-color: rgba(40, 40, 50, 0.8);
            border-radius: 10px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .youtube-item:hover {
            transform: translateY(-5px);
            border-color: rgba(255, 0, 0, 0.5);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .youtube-item.active {
            border-color: #ff0000;
            background-color: rgba(255, 0, 0, 0.1);
        }
        
        .youtube-thumbnail {
            width: 100%;
            height: 160px;
            overflow: hidden;
        }
        
        .youtube-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }
        
        .youtube-item:hover .youtube-thumbnail img {
            transform: scale(1.05);
        }
        
        .youtube-details {
            padding: 15px;
        }
        
        .youtube-title {
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 1.1rem;
            color: #f0f0f0;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .youtube-channel {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }
        
        .youtube-duration {
            font-size: 0.85rem;
            color: #ff0000;
            font-weight: bold;
        }
        
        .device-warning {
            background-color: rgba(255, 0, 0, 0.1);
            border-left: 4px solid #ff0000;
            padding: 15px;
            margin-top: 20px;
            border-radius: 5px;
            font-size: 0.9rem;
            display: none;
        }
        
        .device-warning.show {
            display: block;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            margin-top: 20px;
            opacity: 0.7;
            font-size: 0.9rem;
        }
        
        /* 舊版iPad適配 */
        @media only screen and (max-width: 1024px) and (max-height: 768px) {
            .container {
                max-width: 95%;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .player-container {
                padding: 20px;
            }
            
            .control-btn {
                width: 45px;
                height: 45px;
                margin: 0 8px;
            }
            
            .control-btn.play-pause {
                width: 55px;
                height: 55px;
            }
            
            .playlist {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }
        
        /* 觸控裝置優化 */
        @media (hover: none) and (pointer: coarse) {
            .control-btn {
                min-width: 60px;
                min-height: 60px;
                margin: 0 12px;
            }
            
            .youtube-item {
                padding: 0;
            }
        }
        
        /* 手機適配 */
        @media (max-width: 600px) {
            .player-container {
                padding: 15px;
            }
            
            .playlist {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
        
        /* YouTube播放器自定義 */
        .youtube-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .youtube-search {
            display: flex;
            margin-bottom: 15px;
        }
        
        .youtube-search input {
            flex: 1;
            padding: 12px 15px;
            border: none;
            border-radius: 5px 0 0 5px;
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
        }
        
        .youtube-search button {
            padding: 12px 20px;
            background-color: #ff0000;
            color: white;
            border: none;
            border-radius: 0 5px 5px 0;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        .youtube-search button:hover {
            background-color: #cc0000;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fab fa-youtube"></i> YouTube多媒體播放器</h1>
            <p class="subtitle">YouTube影片與音樂播放器 - 支援舊版iPad (9.5.3+)</p>
        </header>
        
        <div class="player-container">
            <div class="media-section">
                <h2 class="player-title"><i class="fab fa-youtube"></i> YouTube播放器</h2>
                
                <div class="youtube-search">
                    <input type="text" id="youtubeSearch" placeholder="搜尋YouTube影片或輸入影片ID/URL">
                    <button id="searchBtn"><i class="fas fa-search"></i> 搜尋</button>
                </div>
                
                <div class="video-container">
                    <iframe 
                        class="youtube-player" 
                        id="youtubePlayer"
                        src="https://www.youtube.com/embed/jNQXAC9IVRw"
                        frameborder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen>
                    </iframe>
                    
                    <div class="video-placeholder" id="videoPlaceholder">
                        <i class="fab fa-youtube"></i>
                        <p>YouTube影片播放器</p>
                        <p class="select-msg">從下方播放清單選擇影片或使用搜尋功能</p>
                        <button class="select-btn" id="selectVideoBtn">選擇預設影片</button>
                    </div>
                </div>
                
                <div class="youtube-controls">
                    <div class="controls">
                        <button class="control-btn" id="videoRewind">
                            <i class="fas fa-backward"></i>
                        </button>
                        <button class="control-btn play-pause" id="videoPlayPause">
                            <i class="fas fa-play"></i>
                        </button>
                        <button class="control-btn" id="videoForward">
                            <i class="fas fa-forward"></i>
                        </button>
                        <button class="control-btn" id="videoMute">
                            <i class="fas fa-volume-up"></i>
                        </button>
                    </div>
                    
                    <div style="display: flex; align-items: center; margin-top: 10px;">
                        <span style="margin-right: 10px; font-size: 0.9rem;">音量:</span>
                        <input type="range" id="volumeSlider" min="0" max="100" value="50" style="width: 100px;">
                    </div>
                </div>
                
                <div class="video-info" style="margin-top: 15px; padding: 10px; background-color: rgba(255, 255, 255, 0.05); border-radius: 5px;">
                    <div style="font-weight: bold; margin-bottom: 5px;" id="currentVideoTitle">首個YouTube影片 (Me at the zoo)</div>
                    <div style="font-size: 0.9rem; opacity: 0.8;" id="currentVideoChannel">YouTube頻道: jawed</div>
                </div>
            </div>
            
            <div class="media-section">
                <h2 class="player-title"><i class="fas fa-music"></i> 音樂播放器</h2>
                <div class="audio-container">
                    <div class="album-art">
                        <img id="albumArt" src="https://i.ytimg.com/vi/5qap5aO4i9A/hqdefault.jpg" alt="專輯封面">
                    </div>
                    
                    <div class="song-info">
                        <div class="song-title" id="currentSongTitle">lofi hip hop radio - beats to relax/study to</div>
                        <div class="artist" id="currentArtist">Lofi Girl</div>
                    </div>
                    
                    <div class="progress-container">
                        <div class="progress-bar" id="audioProgressBar">
                            <div class="progress" id="audioProgress"></div>
                        </div>
                        <div class="time-display">
                            <span id="audioCurrentTime">0:00</span>
                            <span id="audioDuration">0:00</span>
                        </div>
                    </div>
                    
                    <div class="controls">
                        <button class="control-btn" id="prevSong">
                            <i class="fas fa-step-backward"></i>
                        </button>
                        <button class="control-btn play-pause" id="audioPlayPause">
                            <i class="fas fa-play"></i>
                        </button>
                        <button class="control-btn" id="nextSong">
                            <i class="fas fa-step-forward"></i>
                        </button>
                        <button class="control-btn" id="audioVolume">
                            <i class="fas fa-volume-up"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="youtube-playlist-section">
            <h2 class="player-title"><i class="fas fa-list"></i> YouTube播放清單</h2>
            <div class="playlist" id="youtubePlaylist">
                <!-- YouTube播放清單項目將由JavaScript生成 -->
            </div>
            
            <div class="device-warning" id="deviceWarning">
                <p><i class="fas fa-info-circle"></i> <strong>相容性提示：</strong>此播放器使用YouTube嵌入播放器，確保在舊版iPad (iOS 9.5.3+) 上最佳相容性。若無法播放，請確保設備支援YouTube嵌入功能。</p>
            </div>
        </div>
        
        <footer>
            <p>YouTube多媒體播放器 &copy; 2023 | YouTube為Google LLC商標 | 相容舊版iPad 9.5.3+</p>
        </footer>
    </div>

    <script>
        // 檢測是否為舊版iPad
        function isOldiPad() {
            const userAgent = navigator.userAgent;
            const isiPad = /iPad/.test(userAgent);
            const isSafari = /Safari/.test(userAgent) && !/Chrome/.test(userAgent);
            const iOSVersion = userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/);
            
            if (isiPad && isSafari && iOSVersion) {
                const majorVersion = parseInt(iOSVersion[1]);
                return majorVersion <= 9;
            }
            return false;
        }
        
        // 如果是舊版iPad，顯示提示
        if (isOldiPad()) {
            document.getElementById('deviceWarning').classList.add('show');
        }
        
        // YouTube播放清單 - 預設影片
        const youtubePlaylist = [
            {
                id: "jNQXAC9IVRw",
                title: "首個YouTube影片 - Me at the zoo",
                channel: "jawed",
                duration: "0:19",
                thumbnail: "https://i.ytimg.com/vi/jNQXAC9IVRw/hqdefault.jpg",
                description: "YouTube上傳的第一支影片"
            },
            {
                id: "dQw4w9WgXcQ",
                title: "Rick Astley - Never Gonna Give You Up",
                channel: "Rick Astley",
                duration: "3:33",
                thumbnail: "https://i.ytimg.com/vi/dQw4w9WgXcQ/hqdefault.jpg",
                description: "經典的Rickroll歌曲"
            },
            {
                id: "5qap5aO4i9A",
                title: "lofi hip hop radio - beats to relax/study to",
                channel: "Lofi Girl",
                duration: "直播",
                thumbnail: "https://i.ytimg.com/vi/5qap5aO4i9A/hqdefault.jpg",
                description: "放鬆/學習用的lofi音樂電台"
            },
            {
                id: "9bZkp7q19f0",
                title: "PSY - GANGNAM STYLE (강남스타일) M/V",
                channel: "officialpsy",
                duration: "4:13",
                thumbnail: "https://i.ytimg.com/vi/9bZkp7q19f0/hqdefault.jpg",
                description: "全球爆紅的江南Style"
            },
            {
                id: "kJQP7kiw5Fk",
                title: "Luis Fonsi - Despacito ft. Daddy Yankee",
                channel: "LuisFonsiVEVO",
                duration: "4:42",
                thumbnail: "https://i.ytimg.com/vi/kJQP7kiw5Fk/hqdefault.jpg",
                description: "史上觀看次數最多的YouTube影片之一"
            },
            {
                id: "OPf0YbXqDm0",
                title: "Mark Ronson - Uptown Funk ft. Bruno Mars",
                channel: "MarkRonsonVEVO",
                duration: "4:30",
                thumbnail: "https://i.ytimg.com/vi/OPf0YbXqDm0/hqdefault.jpg",
                description: "暢銷單曲Uptown Funk"
            }
        ];
        
        // 音樂播放清單
        const audioPlaylist = [
            {
                title: "lofi hip hop radio - beats to relax/study to",
                artist: "Lofi Girl",
                duration: "直播",
                src: "https://www.youtube.com/watch?v=5qap5aO4i9A",
                albumArt: "https://i.ytimg.com/vi/5qap5aO4i9A/hqdefault.jpg"
            },
            {
                title: "Chillhop Music",
                artist: "Chillhop Music",
                duration: "直播",
                src: "https://www.youtube.com/watch?v=5yx6BWlEVcY",
                albumArt: "https://i.ytimg.com/vi/5yx6BWlEVcY/hqdefault.jpg"
            },
            {
                title: "Jazz Relaxing Music",
                artist: "Relax Music",
                duration: "3:22:15",
                src: "https://www.youtube.com/watch?v=wJzERGXaUxM",
                albumArt: "https://i.ytimg.com/vi/wJzERGXaUxM/hqdefault.jpg"
            },
            {
                title: "Classical Music for Studying",
                artist: "HALIDONMUSIC",
                duration: "2:03:27",
                src: "https://www.youtube.com/watch?v=wpjNeGdjKfs",
                albumArt: "https://i.ytimg.com/vi/wpjNeGdjKfs/hqdefault.jpg"
            }
        ];
        
        // 獲取DOM元素
        const youtubePlayer = document.getElementById('youtubePlayer');
        const videoPlaceholder = document.getElementById('videoPlaceholder');
        const videoPlayPauseBtn = document.getElementById('videoPlayPause');
        const videoRewindBtn = document.getElementById('videoRewind');
        const videoForwardBtn = document.getElementById('videoForward');
        const videoMuteBtn = document.getElementById('videoMute');
        const volumeSlider = document.getElementById('volumeSlider');
        const youtubeSearch = document.getElementById('youtubeSearch');
        const searchBtn = document.getElementById('searchBtn');
        const selectVideoBtn = document.getElementById('selectVideoBtn');
        const currentVideoTitle = document.getElementById('currentVideoTitle');
        const currentVideoChannel = document.getElementById('currentVideoChannel');
        const youtubePlaylistElement = document.getElementById('youtubePlaylist');
        
        // 音訊播放器
        const audioPlayer = new Audio();
        const audioPlayPauseBtn = document.getElementById('audioPlayPause');
        const prevSongBtn = document.getElementById('prevSong');
        const nextSongBtn = document.getElementById('nextSong');
        const audioVolumeBtn = document.getElementById('audioVolume');
        const audioProgress = document.getElementById('audioProgress');
        const audioProgressBar = document.getElementById('audioProgressBar');
        const audioCurrentTime = document.getElementById('audioCurrentTime');
        const audioDuration = document.getElementById('audioDuration');
        const currentSongTitle = document.getElementById('currentSongTitle');
        const currentArtist = document.getElementById('currentArtist');
        const albumArt = document.getElementById('albumArt');
        
        let currentVideoIndex = 0;
        let currentAudioIndex = 0;
        let isAudioPlaying = false;
        let youtubePlayerReady = false;
        
        // 從URL提取YouTube影片ID
        function extractYouTubeID(url) {
            const regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/;
            const match = url.match(regExp);
            return (match && match[7].length === 11) ? match[7] : null;
        }
        
        // 載入YouTube影片
        function loadYouTubeVideo(videoId, title, channel) {
            // 更新YouTube iframe src
            youtubePlayer.src = `https://www.youtube.com/embed/${videoId}?autoplay=0&rel=0&modestbranding=1`;
            
            // 隱藏佔位符
            videoPlaceholder.style.display = 'none';
            youtubePlayer.style.display = 'block';
            
            // 更新影片資訊
            if (title) currentVideoTitle.textContent = title;
            if (channel) currentVideoChannel.textContent = `YouTube頻道: ${channel}`;
            
            // 標記播放器為準備就緒
            youtubePlayerReady = true;
            
            // 更新播放清單活躍狀態
            updatePlaylistActiveState();
        }
        
        // 初始化YouTube播放清單
        function initYouTubePlaylist() {
            youtubePlaylistElement.innerHTML = '';
            
            youtubePlaylist.forEach((video, index) => {
                const item = document.createElement('div');
                item.className = `youtube-item ${index === currentVideoIndex ? 'active' : ''}`;
                item.innerHTML = `
                    <div class="youtube-thumbnail">
                        <img src="${video.thumbnail}" alt="${video.title}">
                    </div>
                    <div class="youtube-details">
                        <div class="youtube-title">${video.title}</div>
                        <div class="youtube-channel">${video.channel}</div>
                        <div class="youtube-duration">${video.duration}</div>
                    </div>
                `;
                
                item.addEventListener('click', () => {
                    currentVideoIndex = index;
                    loadYouTubeVideo(video.id, video.title, video.channel);
                });
                
                youtubePlaylistElement.appendChild(item);
            });
        }
        
        // 更新播放清單活躍狀態
        function updatePlaylistActiveState() {
            document.querySelectorAll('.youtube-item').forEach((item, index) => {
                if (index === currentVideoIndex) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
        }
        
        // 搜尋/載入YouTube影片
        function searchYouTube() {
            const query = youtubeSearch.value.trim();
            if (!query) return;
            
            // 檢查是否是YouTube URL
            let videoId = extractYouTubeID(query);
            
            if (videoId) {
                // 如果是URL，直接載入影片
                loadYouTubeVideo(videoId, "自訂影片", "使用者提供");
                
                // 添加到播放清單
                youtubePlaylist.push({
                    id: videoId,
                    title: "自訂影片",
                    channel: "使用者提供",
                    duration: "未知",
                    thumbnail: `https://i.ytimg.com/vi/${videoId}/hqdefault.jpg`,
                    description: "使用者自訂影片"
                });
                
                // 更新播放清單
                initYouTubePlaylist();
                currentVideoIndex = youtubePlaylist.length - 1;
                updatePlaylistActiveState();
                
            } else {
                // 否則進行搜尋（簡化版本，實際應用中應使用YouTube API）
                alert("搜尋功能需要YouTube API。目前僅支援直接輸入影片ID或URL。\n\n示例影片ID: jNQXAC9IVRw\n示例URL: https://www.youtube.com/watch?v=jNQXAC9IVRw");
            }
        }
        
        // 初始化音訊播放清單
        function initAudioPlaylist() {
            // 載入第一首歌曲
            playAudio(currentAudioIndex);
        }
        
        // 播放指定音訊
        function playAudio(index) {
            if (index < 0) index = audioPlaylist.length - 1;
            if (index >= audioPlaylist.length) index = 0;
            
            currentAudioIndex = index;
            const song = audioPlaylist[currentAudioIndex];
            
            // 注意：這裡使用YouTube連結，實際音訊播放可能需要使用直接音訊連結
            // 為了相容性，這裡僅顯示資訊，實際播放需要用戶點擊連結
            currentSongTitle.textContent = song.title;
            currentArtist.textContent = song.artist;
            albumArt.src = song.albumArt;
            audioDuration.textContent = song.duration;
            
            // 模擬音訊播放
            simulateAudioPlayback();
        }
        
        // 模擬音訊播放（由於跨域限制，無法直接播放YouTube音訊）
        function simulateAudioPlayback() {
            // 重置進度條
            audioProgress.style.width = '0%';
            audioCurrentTime.textContent = '0:00';
            
            // 模擬播放
            if (isAudioPlaying) {
                // 設置間隔更新進度條
                clearInterval(window.audioSimulation);
                
                window.audioSimulation = setInterval(() => {
                    const currentWidth = parseFloat(audioProgress.style.width) || 0;
                    if (currentWidth < 100) {
                        audioProgress.style.width = (currentWidth + 0.5) + '%';
                        
                        // 計算並顯示當前時間
                        const totalSeconds = 180; // 假設總時長3分鐘
                        const currentSeconds = Math.floor((currentWidth / 100) * totalSeconds);
                        const minutes = Math.floor(currentSeconds / 60);
                        const seconds = currentSeconds % 60;
                        audioCurrentTime.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
                    } else {
                        // 播放結束，播放下一個
                        playAudio(currentAudioIndex + 1);
                    }
                }, 500);
            }
        }
        
        // 格式化時間顯示 (秒 -> 分:秒)
        function formatTime(seconds) {
            if (isNaN(seconds)) return "0:00";
            
            const minutes = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${minutes}:${secs < 10 ? '0' : ''}${secs}`;
        }
        
        // 設定進度條點擊事件
        function setupProgressBar(progressBar, progressElement, timeElement, durationElement, totalDuration) {
            progressBar.addEventListener('click', (e) => {
                const rect = progressBar.getBoundingClientRect();
                const pos = (e.clientX - rect.left) / rect.width;
                const newWidth = pos * 100;
                
                progressElement.style.width = `${newWidth}%`;
                
                // 更新時間顯示
                if (totalDuration) {
                    const currentTime = pos * totalDuration;
                    timeElement.textContent = formatTime(currentTime);
                }
            });
        }
        
        // 初始化
        function init() {
            // 初始化YouTube播放清單
            initYouTubePlaylist();
            
            // 初始化音訊播放清單
            initAudioPlaylist();
            
            // YouTube控制事件
            videoPlayPauseBtn.addEventListener('click', () => {
                if (youtubePlayerReady) {
                    // 注意：由於跨域限制，無法直接控制YouTube iframe
                    // 實際應用中需要使用YouTube IFrame API
                    alert("YouTube控制需要YouTube IFrame API。\n\n請直接點擊影片中的播放按鈕。");
                } else {
                    // 如果播放器未準備好，載入預設影片
                    loadYouTubeVideo(
                        youtubePlaylist[currentVideoIndex].id,
                        youtubePlaylist[currentVideoIndex].title,
                        youtubePlaylist[currentVideoIndex].channel
                    );
                }
            });
            
            videoRewindBtn.addEventListener('click', () => {
                if (youtubePlayerReady) {
                    alert("快退功能需要YouTube IFrame API。");
                }
            });
            
            videoForwardBtn.addEventListener('click', () => {
                if (youtubePlayerReady) {
                    alert("快進功能需要YouTube IFrame API。");
                }
            });
            
            videoMuteBtn.addEventListener('click', () => {
                if (youtubePlayerReady) {
                    alert("靜音功能需要YouTube IFrame API。");
                } else {
                    // 切換靜音圖示
                    const isMuted = videoMuteBtn.innerHTML.includes('volume-mute');
                    videoMuteBtn.innerHTML = isMuted ? 
                        '<i class="fas fa-volume-up"></i>' : 
                        '<i class="fas fa-volume-mute"></i>';
                }
            });
            
            volumeSlider.addEventListener('input', (e) => {
                // 更新音量顯示
                const volume = e.target.value;
                
                if (youtubePlayerReady) {
                    // 實際應用中需要使用YouTube IFrame API
                }
            });
            
            // 搜尋功能
            searchBtn.addEventListener('click', searchYouTube);
            
            youtubeSearch.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    searchYouTube();
                }
            });
            
            selectVideoBtn.addEventListener('click', () => {
                loadYouTubeVideo(
                    youtubePlaylist[0].id,
                    youtubePlaylist[0].title,
                    youtubePlaylist[0].channel
                );
                currentVideoIndex = 0;
                updatePlaylistActiveState();
            });
            
            // 音訊播放器事件
            audioPlayPauseBtn.addEventListener('click', () => {
                isAudioPlaying = !isAudioPlaying;
                
                if (isAudioPlaying) {
                    audioPlayPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                    simulateAudioPlayback();
                } else {
                    audioPlayPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                    clearInterval(window.audioSimulation);
                }
            });
            
            prevSongBtn.addEventListener('click', () => {
                playAudio(currentAudioIndex - 1);
            });
            
            nextSongBtn.addEventListener('click', () => {
                playAudio(currentAudioIndex + 1);
            });
            
            audioVolumeBtn.addEventListener('click', () => {
                audioPlayer.muted = !audioPlayer.muted;
                audioVolumeBtn.innerHTML = audioPlayer.muted ? 
                    '<i class="fas fa-volume-mute"></i>' : 
                    '<i class="fas fa-volume-up"></i>';
            });
            
            // 設定音訊進度條點擊事件
            setupProgressBar(
                audioProgressBar, 
                audioProgress, 
                audioCurrentTime, 
                audioDuration,
                180 // 假設總時長3分鐘
            );
            
            // 點擊音訊專輯封面時，載入對應的YouTube影片
            albumArt.addEventListener('click', () => {
                const song = audioPlaylist[currentAudioIndex];
                // 嘗試從YouTube URL提取ID
                const videoId = extractYouTubeID(song.src);
                if (videoId) {
                    // 尋找對應的影片索引
                    const videoIndex = youtubePlaylist.findIndex(v => v.id === videoId);
                    if (videoIndex !== -1) {
                        currentVideoIndex = videoIndex;
                        loadYouTubeVideo(
                            youtubePlaylist[videoIndex].id,
                            youtubePlaylist[videoIndex].title,
                            youtubePlaylist[videoIndex].channel
                        );
                    } else {
                        // 如果不在播放清單中，直接載入
                        loadYouTubeVideo(videoId, song.title, song.artist);
                    }
                }
            });
        }
        
        // 當頁面載入完成時初始化播放器
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
